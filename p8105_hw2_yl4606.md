p8105\_hw2\_yl4606
================
Yubei Liang
9/28/2020

This is my HW2 solutions.

``` r
library(tidyverse)
library(readxl)
```

# Problem 1

Read and clean the Mr. Trashwheel dataset.

``` r
trash_df = 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "Mr. Trash Wheel",
    range = cell_cols("A:N")) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Read and clean the 2017 and 2018 precipitation datasets.

``` r
precipitation_2017_df = 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2017 Precipitation",
    skip = 1,
  ) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2017) %>%
  relocate(year)

precipitation_2018_df = 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2018 Precipitation",
    skip = 1,
  ) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2018) %>%
  relocate(year)
```

Combine two precipitation datasets.

``` r
precip_df = 
  bind_rows( precipitation_2017_df, precipitation_2018_df)
```

For Mr. Wheel Trsh data frame, there are 344 times of dumpster
obervation. Key variables include dumpster, month, year, date,
weight\_tons, volume\_cubic\_yards, plastic\_bottles, polystyrene,
cigarette\_butts, glass\_bottles, grocery\_bags, chip\_bags,
sports\_balls, homes\_powered . For precipitation data frame, there are
24 times of obervation. Key variables include year, month, total . The
total precipitation for 2018 is 70.33. The median number of sports balls
in a dumpster in 2017 is 8.

``` r
rm(sb, precipitation_2018_df, precipitation_2017_df)
```

# Problem 2

Read and clean the NYC subway dataset.

``` r
raw_nyc_subway_df = 
  read_csv(
  "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv"
  ) %>%
  janitor::clean_names() 

new_nyc_subway_df = 
  raw_nyc_subway_df %>%
  select(line, station_name, station_latitude, station_longitude, route1:route11, entrance_type, entry, vending, ada) %>%
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE),
         route8 = as.character(route8),
         route9 = as.character(route9),
         route10 = as.character(route10),
         route11 = as.character(route11),
         vending = recode(vending, "YES" = TRUE, "NO" = FALSE))
```

The raw NYC subway dataset include variables division, line,
station\_name, station\_latitude, station\_longitude, route1, route2,
route3, route4, route5, route6, route7, route8, route9, route10,
route11, entrance\_type, entry, exit\_only, vending, staffing,
staff\_hours, ada, ada\_notes, free\_crossover, north\_south\_street,
east\_west\_street, corner, entrance\_latitude, entrance\_longitude,
station\_location, entrance\_location. My cleaning process include
reading data, cleaning variable names using janitor package, selecting
key variables (line, station\_name, station\_latitude,
station\_longitude, route1, route2, route3, route4, route5, route6,
route7, route8, route9, route10, route11, entrance\_type, entry,
vending, ada). Finally, I use recode() function to convert variable
‘entry’ from character to logical, variable ‘vending’ from character
to logical, and all variables with prefix ‘route’ are converted to the
same class character for furthur explore. NAs are not removed because
the NAs here are informative with regard to routes. The dimention of the
resulting dataset is 1868 rows by 19 columns. No, the data looks not
tidy for me. For variables and values start with ‘route’, although they
are human readable, it is inconvenient to use computer language to fetch
informations.

There are 465 distinct subway stations, 84 of them are ADA compliant.
0.3770492 fraction of station entrances / exits without vending allow
entrance.

``` r
reformat_nyc_subway_df<-
  new_nyc_subway_df%>%
  pivot_longer(
    route1 : route11,
    names_to = "route_number",
    values_to = "route_name"
    ) %>%
  drop_na(route_name)
```

After reformating data, 60 distinct stations serve the A train. 17 of
them are ADA compliant.

# Problem 3

Read and clean the data in pols-month.csv.

``` r
# create a tibble to convert month number
month_df = 
  tibble(
    month = 1:12,
    month_name = month.name
  )

pols_month_df = 
  read_csv(
    "./Data/fivethirtyeight_datasets/pols-month.csv"
  ) %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(month = as.integer(month)) %>% 
  left_join(month_df, by = "month") %>% 
  select(-c(month)) %>% 
  relocate(year, month_name) %>% 
  rename(
    gop = prez_gop,
    dem = prez_dem
  ) %>% 
  pivot_longer(
    c(gop, dem),
    names_to = "president",
    values_to = "president_num",
  ) %>%
  filter( president_num == 1) %>% 
  select(-c(president_num, day)) %>% 
  relocate(year, month_name, president)
```
